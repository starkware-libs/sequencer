# Proving Service Usage Guide

## Service Info

| Field | Value |
|-------|-------|
| **Public URL** | `http://35.239.133.241:3000` |
| **Protocol** | JSON-RPC 2.0 |
| **Namespace** | `privacy-starknet-pathfinder` |
| **Chain** | `SN_INTEGRATION_SEPOLIA` |
| **RPC Node** | pathfinder (same namespace, port 9545, v0.10 API) |

## Available Methods

### `starknet_specVersion`

Health check / version endpoint.

```bash
curl -s -X POST http://35.239.133.241:3000 \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","method":"starknet_specVersion","params":[],"id":1}'
```

Response: `{"jsonrpc":"2.0","id":1,"result":"0.10.0"}`

### `starknet_proveTransaction`

Proves an invoke transaction on top of the latest (or a specific) block. The service:
1. Fetches the current state from the RPC node
2. Executes the transaction in a virtual block
3. Runs the Starknet OS
4. Generates a STARK proof using the Stwo prover

**Parameters:**
- `block_id`: `"latest"` or `{"block_number": 12345}` or `{"block_hash": "0x..."}`
- `transaction`: An Invoke V3 transaction in Starknet RPC format

## Sending a Transaction

### Using the Dummy Account (no signature required)

A dummy account is deployed on Integration Sepolia that accepts any signature:

| Field | Value |
|-------|-------|
| **Address** | `0x037ee64c5681f8d1eea73429144d6a5c0ef271759a1d4342de13cef520fe35a7` |
| **Class Hash** | `0x03ffa2071348a2e0a4e6827789a235809e681cb34124e260542d75096060d827` |
| **Fee Token** | `0x70a5da4f557b77a9c54546e4bcc900806e28793d8e3eaaa207428d2387249b7` |

### Step 1: Get the current nonce

```bash
curl -s -X POST http://34.170.239.64:9545/rpc/v0_10 \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc":"2.0",
    "method":"starknet_getNonce",
    "params":{
      "block_id":"latest",
      "contract_address":"0x037ee64c5681f8d1eea73429144d6a5c0ef271759a1d4342de13cef520fe35a7"
    },
    "id":1
  }'
```

Note the returned nonce (e.g. `"0x5"`).

### Step 2: Send the prove request

Replace `NONCE` with the value from step 1.

```bash
curl -s --max-time 600 -X POST http://35.239.133.241:3000 \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "starknet_proveTransaction",
    "params": {
      "block_id": "latest",
      "transaction": {
        "type": "INVOKE",
        "version": "0x3",
        "sender_address": "0x037ee64c5681f8d1eea73429144d6a5c0ef271759a1d4342de13cef520fe35a7",
        "calldata": [
          "0x70a5da4f557b77a9c54546e4bcc900806e28793d8e3eaaa207428d2387249b7",
          "0x35a73cd311a05d46deda634c5ee045db92f811b4e74bca4437fcb5302b7af33",
          "0x1",
          "0x037ee64c5681f8d1eea73429144d6a5c0ef271759a1d4342de13cef520fe35a7"
        ],
        "signature": [],
        "nonce": "NONCE",
        "resource_bounds": {
          "l1_gas": {"max_amount": "0x0", "max_price_per_unit": "0x0"},
          "l2_gas": {"max_amount": "0x989680", "max_price_per_unit": "0x0"},
          "l1_data_gas": {"max_amount": "0x0", "max_price_per_unit": "0x0"}
        },
        "tip": "0x0",
        "paymaster_data": [],
        "account_deployment_data": [],
        "nonce_data_availability_mode": "L1",
        "fee_data_availability_mode": "L1"
      }
    },
    "id": 1
  }' -o proof_result.json
```

### Step 3: Inspect the result

```bash
python3 -c "
import json
with open('proof_result.json') as f:
    data = json.load(f)
r = data['result']
print(f'Proof: {len(r[\"proof\"])} u32 values')
print(f'Proof facts: {json.dumps(r[\"proof_facts\"], indent=2)}')
print(f'L2->L1 messages: {r[\"l2_to_l1_messages\"]}')
"
```

## Response Format

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "proof": [1, 6360064, ...],
    "proof_facts": [
      "0x50524f4f4630",
      "0x5649525455414c5f534e4f53",
      "0x7",
      "0x68b33c07b015b6dbfa13f9424037fe4e36b42c9f446e1f76c4f0e86c7355c0f",
      "0x5649525455414c5f534e4f5330",
      "0x5cbc2",
      "0xeb7626e93ee7b30d8f858e0f94c39e6d1f3cc43cba7fd304e07cbcea182c56",
      "0x5fa1ee0f3971ddd03b1ba861f16503eb1d8e3b3889e20e905f3d1da9c30f3da",
      "0x0"
    ],
    "l2_to_l1_messages": []
  }
}
```

| Field | Description |
|-------|-------------|
| `proof` | STARK proof as array of u32 values (packed 4 bytes big-endian) |
| `proof_facts` | Program output identifying the proven computation |
| `l2_to_l1_messages` | Any L2-to-L1 messages generated by the transaction |

## Important Notes

- Proving takes ~1-2 minutes per transaction
- Set `--max-time 600` on curl to avoid timeouts
- The nonce must match the account's current on-chain nonce
- Only Invoke V3 transactions are supported (Declare and DeployAccount are not)
- `block_id: "pending"` is not supported