# does not build, only copies the binary from the local machine
FROM ubuntu:24.04

RUN apt update && apt -y install iproute2 kmod chrony net-tools tcpdump && apt clean && rm -rf /var/lib/apt/lists/*

COPY --from=tmp broadcast_network_stress_test_node /usr/local/bin/broadcast_network_stress_test_node
COPY ./crates/apollo_network/src/bin/broadcast_network_stress_test_node/run/entrypoint.sh /entrypoint.sh
COPY ./crates/apollo_network/src/bin/broadcast_network_stress_test_node/run/tcp_config.sh /tcp_config.sh

RUN chmod +x /entrypoint.sh
RUN chmod +x /tcp_config.sh

RUN /tcp_config.sh

ENTRYPOINT ["/entrypoint.sh"]
