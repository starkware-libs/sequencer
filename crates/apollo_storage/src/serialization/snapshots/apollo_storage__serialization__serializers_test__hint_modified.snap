---
source: crates/apollo_storage/src/serialization/serializers_test.rs
expression: hint_schema
---
$schema: "https://json-schema.org/draft/2020-12/schema"
title: CoreHintBase
anyOf:
  - $ref: "#/$defs/CoreHint"
  - $ref: "#/$defs/DeprecatedHint"
$defs:
  BigInt:
    type: object
    properties:
      data:
        $ref: "#/$defs/BigUint"
      sign:
        $ref: "#/$defs/Sign"
    required:
      - sign
      - data
  BigIntAsHex:
    description: A field element that encodes the signature of the called function.
    $ref: "#/$defs/BigInt"
  BigUint:
    type: object
    properties:
      data:
        type: array
        items:
          type: integer
          format: uint64
          minimum:
            "$serde_json::private::Number": "0"
    required:
      - data
  BinOpOperand:
    type: object
    properties:
      a:
        $ref: "#/$defs/CellRef"
      b:
        $ref: "#/$defs/DerefOrImmediate"
      op:
        $ref: "#/$defs/Operation"
    required:
      - op
      - a
      - b
  CellRef:
    description: "Represents an operand of the form [reg + offset]."
    type: object
    properties:
      offset:
        type: integer
        format: int16
        maximum:
          "$serde_json::private::Number": "32767"
        minimum:
          "$serde_json::private::Number": "-32768"
      register:
        $ref: "#/$defs/Register"
    required:
      - register
      - offset
  CoreHint:
    oneOf:
      - type: object
        properties:
          AllocSegment:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
            required:
              - dst
        additionalProperties: false
        required:
          - AllocSegment
      - type: object
        properties:
          TestLessThan:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
              lhs:
                $ref: "#/$defs/ResOperand"
              rhs:
                $ref: "#/$defs/ResOperand"
            required:
              - lhs
              - rhs
              - dst
        additionalProperties: false
        required:
          - TestLessThan
      - type: object
        properties:
          TestLessThanOrEqual:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
              lhs:
                $ref: "#/$defs/ResOperand"
              rhs:
                $ref: "#/$defs/ResOperand"
            required:
              - lhs
              - rhs
              - dst
        additionalProperties: false
        required:
          - TestLessThanOrEqual
      - description: Variant of TestLessThanOrEqual that compares addresses.
        type: object
        properties:
          TestLessThanOrEqualAddress:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
              lhs:
                $ref: "#/$defs/ResOperand"
              rhs:
                $ref: "#/$defs/ResOperand"
            required:
              - lhs
              - rhs
              - dst
        additionalProperties: false
        required:
          - TestLessThanOrEqualAddress
      - description: "Multiplies two 128-bit integers and returns two 128-bit integers: the high and low parts of\nthe product."
        type: object
        properties:
          WideMul128:
            type: object
            properties:
              high:
                $ref: "#/$defs/CellRef"
              lhs:
                $ref: "#/$defs/ResOperand"
              low:
                $ref: "#/$defs/CellRef"
              rhs:
                $ref: "#/$defs/ResOperand"
            required:
              - lhs
              - rhs
              - high
              - low
        additionalProperties: false
        required:
          - WideMul128
      - description: "Computes lhs/rhs and returns the quotient and remainder.\n\nNote: the hint may be used to write an already assigned memory cell."
        type: object
        properties:
          DivMod:
            type: object
            properties:
              lhs:
                $ref: "#/$defs/ResOperand"
              quotient:
                $ref: "#/$defs/CellRef"
              remainder:
                $ref: "#/$defs/CellRef"
              rhs:
                $ref: "#/$defs/ResOperand"
            required:
              - lhs
              - rhs
              - quotient
              - remainder
        additionalProperties: false
        required:
          - DivMod
      - description: "Divides dividend (represented by 2 128-bit limbs) by divisor (represented by 2 128-bit\nlimbs). Returns the quotient (represented by 2 128-bit limbs) and remainder (represented by\n2 128-bit limbs). In all cases, `name`0 is the least significant limb."
        type: object
        properties:
          Uint256DivMod:
            type: object
            properties:
              dividend0:
                $ref: "#/$defs/ResOperand"
              dividend1:
                $ref: "#/$defs/ResOperand"
              divisor0:
                $ref: "#/$defs/ResOperand"
              divisor1:
                $ref: "#/$defs/ResOperand"
              quotient0:
                $ref: "#/$defs/CellRef"
              quotient1:
                $ref: "#/$defs/CellRef"
              remainder0:
                $ref: "#/$defs/CellRef"
              remainder1:
                $ref: "#/$defs/CellRef"
            required:
              - dividend0
              - dividend1
              - divisor0
              - divisor1
              - quotient0
              - quotient1
              - remainder0
              - remainder1
        additionalProperties: false
        required:
          - Uint256DivMod
      - description: "Divides dividend (represented by 4 128-bit limbs) by divisor (represented by 2 128-bit\nlimbs). Returns the quotient (represented by 4 128-bit limbs) and remainder (represented\nby 2 128-bit limbs).\nIn all cases, `name`0 is the least significant limb."
        type: object
        properties:
          Uint512DivModByUint256:
            type: object
            properties:
              dividend0:
                $ref: "#/$defs/ResOperand"
              dividend1:
                $ref: "#/$defs/ResOperand"
              dividend2:
                $ref: "#/$defs/ResOperand"
              dividend3:
                $ref: "#/$defs/ResOperand"
              divisor0:
                $ref: "#/$defs/ResOperand"
              divisor1:
                $ref: "#/$defs/ResOperand"
              quotient0:
                $ref: "#/$defs/CellRef"
              quotient1:
                $ref: "#/$defs/CellRef"
              quotient2:
                $ref: "#/$defs/CellRef"
              quotient3:
                $ref: "#/$defs/CellRef"
              remainder0:
                $ref: "#/$defs/CellRef"
              remainder1:
                $ref: "#/$defs/CellRef"
            required:
              - dividend0
              - dividend1
              - dividend2
              - dividend3
              - divisor0
              - divisor1
              - quotient0
              - quotient1
              - quotient2
              - quotient3
              - remainder0
              - remainder1
        additionalProperties: false
        required:
          - Uint512DivModByUint256
      - type: object
        properties:
          SquareRoot:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
              value:
                $ref: "#/$defs/ResOperand"
            required:
              - value
              - dst
        additionalProperties: false
        required:
          - SquareRoot
      - description: "Computes the square root of value_low<<128+value_high, stores the 64-bit limbs of the result\nin sqrt0 and sqrt1 as well as the 128-bit limbs of the remainder in remainder_low and\nremainder_high. The remainder is defined as `value - sqrt**2`.\nLastly, it checks whether `2*sqrt - remainder >= 2**128`."
        type: object
        properties:
          Uint256SquareRoot:
            type: object
            properties:
              remainder_high:
                $ref: "#/$defs/CellRef"
              remainder_low:
                $ref: "#/$defs/CellRef"
              sqrt0:
                $ref: "#/$defs/CellRef"
              sqrt1:
                $ref: "#/$defs/CellRef"
              sqrt_mul_2_minus_remainder_ge_u128:
                $ref: "#/$defs/CellRef"
              value_high:
                $ref: "#/$defs/ResOperand"
              value_low:
                $ref: "#/$defs/ResOperand"
            required:
              - value_low
              - value_high
              - sqrt0
              - sqrt1
              - remainder_low
              - remainder_high
              - sqrt_mul_2_minus_remainder_ge_u128
        additionalProperties: false
        required:
          - Uint256SquareRoot
      - description: "Finds some `x` and `y` such that `x * scalar + y = value` and `x <= max_x`."
        type: object
        properties:
          LinearSplit:
            type: object
            properties:
              max_x:
                $ref: "#/$defs/ResOperand"
              scalar:
                $ref: "#/$defs/ResOperand"
              value:
                $ref: "#/$defs/ResOperand"
              x:
                $ref: "#/$defs/CellRef"
              y:
                $ref: "#/$defs/CellRef"
            required:
              - value
              - scalar
              - max_x
              - x
              - y
        additionalProperties: false
        required:
          - LinearSplit
      - description: Allocates a new dict segment and writes its start address into the dict_infos segment.
        type: object
        properties:
          AllocFelt252Dict:
            type: object
            properties:
              segment_arena_ptr:
                $ref: "#/$defs/ResOperand"
            required:
              - segment_arena_ptr
        additionalProperties: false
        required:
          - AllocFelt252Dict
      - description: Fetches the previous value of a key in a dict and writes it in a new dict access.
        type: object
        properties:
          Felt252DictEntryInit:
            type: object
            properties:
              dict_ptr:
                $ref: "#/$defs/ResOperand"
              key:
                $ref: "#/$defs/ResOperand"
            required:
              - dict_ptr
              - key
        additionalProperties: false
        required:
          - Felt252DictEntryInit
      - description: "Similar to Felt252DictWrite, but updates an existing entry and does not write the previous\nvalue to the stack."
        type: object
        properties:
          Felt252DictEntryUpdate:
            type: object
            properties:
              dict_ptr:
                $ref: "#/$defs/ResOperand"
              value:
                $ref: "#/$defs/ResOperand"
            required:
              - dict_ptr
              - value
        additionalProperties: false
        required:
          - Felt252DictEntryUpdate
      - description: Retrieves the index of the given dict in the dict_infos segment.
        type: object
        properties:
          GetSegmentArenaIndex:
            type: object
            properties:
              dict_end_ptr:
                $ref: "#/$defs/ResOperand"
              dict_index:
                $ref: "#/$defs/CellRef"
            required:
              - dict_end_ptr
              - dict_index
        additionalProperties: false
        required:
          - GetSegmentArenaIndex
      - description: Initializes the lists of accesses for each key in a dict in preparation for squash_dict.
        type: object
        properties:
          InitSquashData:
            type: object
            properties:
              big_keys:
                $ref: "#/$defs/CellRef"
              dict_accesses:
                $ref: "#/$defs/ResOperand"
              first_key:
                $ref: "#/$defs/CellRef"
              n_accesses:
                $ref: "#/$defs/ResOperand"
              ptr_diff:
                $ref: "#/$defs/ResOperand"
            required:
              - dict_accesses
              - ptr_diff
              - n_accesses
              - big_keys
              - first_key
        additionalProperties: false
        required:
          - InitSquashData
      - description: Retrieves the current index of a dict access to process.
        type: object
        properties:
          GetCurrentAccessIndex:
            type: object
            properties:
              range_check_ptr:
                $ref: "#/$defs/ResOperand"
            required:
              - range_check_ptr
        additionalProperties: false
        required:
          - GetCurrentAccessIndex
      - description: Writes whether the squash_dict loop should be skipped.
        type: object
        properties:
          ShouldSkipSquashLoop:
            type: object
            properties:
              should_skip_loop:
                $ref: "#/$defs/CellRef"
            required:
              - should_skip_loop
        additionalProperties: false
        required:
          - ShouldSkipSquashLoop
      - description: Writes the delta from the current access index to the next one.
        type: object
        properties:
          GetCurrentAccessDelta:
            type: object
            properties:
              index_delta_minus1:
                $ref: "#/$defs/CellRef"
            required:
              - index_delta_minus1
        additionalProperties: false
        required:
          - GetCurrentAccessDelta
      - description: Writes whether the squash_dict loop should continue.
        type: object
        properties:
          ShouldContinueSquashLoop:
            type: object
            properties:
              should_continue:
                $ref: "#/$defs/CellRef"
            required:
              - should_continue
        additionalProperties: false
        required:
          - ShouldContinueSquashLoop
      - description: Writes the next dict key to process.
        type: object
        properties:
          GetNextDictKey:
            type: object
            properties:
              next_key:
                $ref: "#/$defs/CellRef"
            required:
              - next_key
        additionalProperties: false
        required:
          - GetNextDictKey
      - description: "Finds the two small arcs from within [(0,a),(a,b),(b,PRIME)] and writes them to the\nrange_check segment."
        type: object
        properties:
          AssertLeFindSmallArcs:
            type: object
            properties:
              a:
                $ref: "#/$defs/ResOperand"
              b:
                $ref: "#/$defs/ResOperand"
              range_check_ptr:
                $ref: "#/$defs/ResOperand"
            required:
              - range_check_ptr
              - a
              - b
        additionalProperties: false
        required:
          - AssertLeFindSmallArcs
      - description: "Writes whether the arc (0,a) was excluded."
        type: object
        properties:
          AssertLeIsFirstArcExcluded:
            type: object
            properties:
              skip_exclude_a_flag:
                $ref: "#/$defs/CellRef"
            required:
              - skip_exclude_a_flag
        additionalProperties: false
        required:
          - AssertLeIsFirstArcExcluded
      - description: "Writes whether the arc (a,b) was excluded."
        type: object
        properties:
          AssertLeIsSecondArcExcluded:
            type: object
            properties:
              skip_exclude_b_minus_a:
                $ref: "#/$defs/CellRef"
            required:
              - skip_exclude_b_minus_a
        additionalProperties: false
        required:
          - AssertLeIsSecondArcExcluded
      - description: Samples a random point on the EC.
        type: object
        properties:
          RandomEcPoint:
            type: object
            properties:
              x:
                $ref: "#/$defs/CellRef"
              y:
                $ref: "#/$defs/CellRef"
            required:
              - x
              - y
        additionalProperties: false
        required:
          - RandomEcPoint
      - description: "Computes the square root of `val`, if `val` is a quadratic residue, and of `3 * val`\notherwise.\n\nSince 3 is not a quadratic residue, exactly one of `val` and `3 * val` is a quadratic\nresidue (unless `val` is 0). This allows proving that `val` is not a quadratic residue."
        type: object
        properties:
          FieldSqrt:
            type: object
            properties:
              sqrt:
                $ref: "#/$defs/CellRef"
              val:
                $ref: "#/$defs/ResOperand"
            required:
              - val
              - sqrt
        additionalProperties: false
        required:
          - FieldSqrt
      - description: "Prints the values from start to end.\nBoth must be pointers."
        type: object
        properties:
          DebugPrint:
            type: object
            properties:
              end:
                $ref: "#/$defs/ResOperand"
              start:
                $ref: "#/$defs/ResOperand"
            required:
              - start
              - end
        additionalProperties: false
        required:
          - DebugPrint
      - description: "Returns an address with `size` free locations afterwards."
        type: object
        properties:
          AllocConstantSize:
            type: object
            properties:
              dst:
                $ref: "#/$defs/CellRef"
              size:
                $ref: "#/$defs/ResOperand"
            required:
              - size
              - dst
        additionalProperties: false
        required:
          - AllocConstantSize
      - description: "Provides the inverse of b (represented by 2 128-bit limbs) modulo n (represented by 2\n128-bit limbs), or a proof that b has no inverse.\n\nIn case b has an inverse: Returns `r` and `k` such that:\n  * `r = 1 / b (mod n)`\n  * `k = (r * b - 1) / n`\n  * `g0_or_no_inv = 0`\n\nIn case b has no inverse: Returns `g`, `s`, and `t`, such that:\n`g > 1`\n`g == 2 || g % 2 == 1` (in particular, `g0_or_no_inv = g0 != 0`)\n`g * s = b`\n`g * t = n`\n\nThe case `n == 1` is considered \"no-inverse\" (special case).\nIn this case: Returns `g == 1`, `s == b` and `t == 1`.\nAll no-inverse requirements are satisfied, except for `g > 1`.\n\nIn all cases, `name`0 is the least significant limb."
        type: object
        properties:
          U256InvModN:
            type: object
            properties:
              b0:
                $ref: "#/$defs/ResOperand"
              b1:
                $ref: "#/$defs/ResOperand"
              g0_or_no_inv:
                $ref: "#/$defs/CellRef"
              g1_option:
                $ref: "#/$defs/CellRef"
              n0:
                $ref: "#/$defs/ResOperand"
              n1:
                $ref: "#/$defs/ResOperand"
              s_or_r0:
                $ref: "#/$defs/CellRef"
              s_or_r1:
                $ref: "#/$defs/CellRef"
              t_or_k0:
                $ref: "#/$defs/CellRef"
              t_or_k1:
                $ref: "#/$defs/CellRef"
            required:
              - b0
              - b1
              - n0
              - n1
              - g0_or_no_inv
              - g1_option
              - s_or_r0
              - s_or_r1
              - t_or_k0
              - t_or_k1
        additionalProperties: false
        required:
          - U256InvModN
      - type: object
        properties:
          EvalCircuit:
            type: object
            properties:
              add_mod_builtin:
                $ref: "#/$defs/ResOperand"
              mul_mod_builtin:
                $ref: "#/$defs/ResOperand"
              n_add_mods:
                $ref: "#/$defs/ResOperand"
              n_mul_mods:
                $ref: "#/$defs/ResOperand"
            required:
              - n_add_mods
              - add_mod_builtin
              - n_mul_mods
              - mul_mod_builtin
        additionalProperties: false
        required:
          - EvalCircuit
  DeprecatedHint:
    description: "Represents a deprecated hint that is kept for backward compatibility with previously deployed\ncontracts."
    oneOf:
      - description: Asserts that the current access indices list is empty (after the loop).
        type: string
        const: AssertCurrentAccessIndicesIsEmpty
      - description: "Asserts that the number of used accesses is equal to the length of the original accesses\nlist."
        type: object
        properties:
          AssertAllAccessesUsed:
            type: object
            properties:
              n_used_accesses:
                $ref: "#/$defs/CellRef"
            required:
              - n_used_accesses
        additionalProperties: false
        required:
          - AssertAllAccessesUsed
      - description: Asserts that the keys list is empty.
        type: string
        const: AssertAllKeysUsed
      - description: "Asserts that the arc (b, PRIME) was excluded."
        type: string
        const: AssertLeAssertThirdArcExcluded
      - description: Asserts that the input represents integers and that a<b.
        type: object
        properties:
          AssertLtAssertValidInput:
            type: object
            properties:
              a:
                $ref: "#/$defs/ResOperand"
              b:
                $ref: "#/$defs/ResOperand"
            required:
              - a
              - b
        additionalProperties: false
        required:
          - AssertLtAssertValidInput
      - description: "Retrieves and writes the value corresponding to the given dict and key from the VM\ndict_manager."
        type: object
        properties:
          Felt252DictRead:
            type: object
            properties:
              dict_ptr:
                $ref: "#/$defs/ResOperand"
              key:
                $ref: "#/$defs/ResOperand"
              value_dst:
                $ref: "#/$defs/CellRef"
            required:
              - dict_ptr
              - key
              - value_dst
        additionalProperties: false
        required:
          - Felt252DictRead
      - description: Sets the value corresponding to the key in the VM dict_manager.
        type: object
        properties:
          Felt252DictWrite:
            type: object
            properties:
              dict_ptr:
                $ref: "#/$defs/ResOperand"
              key:
                $ref: "#/$defs/ResOperand"
              value:
                $ref: "#/$defs/ResOperand"
            required:
              - dict_ptr
              - key
              - value
        additionalProperties: false
        required:
          - Felt252DictWrite
  DerefOrImmediate:
    oneOf:
      - type: object
        properties:
          Deref:
            $ref: "#/$defs/CellRef"
        additionalProperties: false
        required:
          - Deref
      - type: object
        properties:
          Immediate:
            $ref: "#/$defs/BigIntAsHex"
        additionalProperties: false
        required:
          - Immediate
  Operation:
    type: string
    enum:
      - Add
      - Mul
  Register:
    type: string
    enum:
      - AP
      - FP
  ResOperand:
    oneOf:
      - type: object
        properties:
          Deref:
            $ref: "#/$defs/CellRef"
        additionalProperties: false
        required:
          - Deref
      - type: object
        properties:
          DoubleDeref:
            type: array
            maxItems:
              "$serde_json::private::Number": "2"
            minItems:
              "$serde_json::private::Number": "2"
            prefixItems:
              - $ref: "#/$defs/CellRef"
              - type: integer
                format: int16
                maximum:
                  "$serde_json::private::Number": "32767"
                minimum:
                  "$serde_json::private::Number": "-32768"
        additionalProperties: false
        required:
          - DoubleDeref
      - type: object
        properties:
          Immediate:
            $ref: "#/$defs/BigIntAsHex"
        additionalProperties: false
        required:
          - Immediate
      - type: object
        properties:
          BinOp:
            $ref: "#/$defs/BinOpOperand"
        additionalProperties: false
        required:
          - BinOp
  Sign:
    type: string
    enum:
      - Minus
      - NoSign
      - Plus
